<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JARVIS 2.0</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Roboto+Mono:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        *,*::before,*::after{margin:0;padding:0;box-sizing:border-box}

        :root{
            --bg:#0a0e17;--bg2:#111827;--bg3:#1a2235;
            --card:rgba(26,34,53,0.6);--glass:rgba(17,24,39,0.4);
            --brd:rgba(0,255,255,0.08);--brd-a:rgba(0,255,255,0.3);
            --cyan:#00f0ff;--cyan-d:rgba(0,240,255,0.12);
            --violet:#8b5cf6;--violet-d:rgba(139,92,246,0.12);
            --pink:#f472b6;--green:#34d399;--green-d:rgba(52,211,153,0.12);
            --yellow:#fbbf24;--yellow-d:rgba(251,191,36,0.12);
            --red:#f87171;--red-d:rgba(248,113,113,0.12);
            --t1:#e2e8f0;--t2:#94a3b8;--t3:#475569;
            --sans:'Inter',sans-serif;--mono:'Roboto Mono',monospace;
            --r-s:6px;--r-m:10px;--r-l:16px;--r-xl:20px
        }

        html{font-size:14px}
        body{font-family:var(--sans);background:var(--bg);color:var(--t1);overflow:hidden;height:100vh}

        body::before{content:'';position:fixed;inset:0;
            background:radial-gradient(800px 600px at 20% 50%,rgba(0,240,255,0.03),transparent 70%),
            radial-gradient(600px 800px at 80% 20%,rgba(139,92,246,0.03),transparent 70%);
            pointer-events:none;z-index:0}

        .grid-bg{position:fixed;inset:0;
            background-image:linear-gradient(rgba(0,240,255,0.012) 1px,transparent 1px),
            linear-gradient(90deg,rgba(0,240,255,0.012) 1px,transparent 1px);
            background-size:60px 60px;pointer-events:none;z-index:0}

        .scan{position:fixed;left:0;right:0;height:2px;
            background:linear-gradient(90deg,transparent,var(--cyan),transparent);
            opacity:.06;animation:sc 8s linear infinite;pointer-events:none;z-index:9999}
        @keyframes sc{0%{top:-2px}100%{top:100vh}}

        /* LAYOUT */
        .app{display:grid;grid-template-columns:260px 1fr 340px;grid-template-rows:50px 1fr;height:100vh;position:relative;z-index:1}

        /* TOPBAR */
        .top{grid-column:1/-1;display:flex;align-items:center;justify-content:space-between;padding:0 14px;
            background:rgba(10,14,23,0.9);backdrop-filter:blur(20px);border-bottom:1px solid var(--brd)}

        .logo{display:flex;align-items:center;gap:8px}
        .logo-i{width:28px;height:28px;background:linear-gradient(135deg,var(--cyan),var(--violet));border-radius:7px;
            display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:900;color:var(--bg);
            box-shadow:0 0 12px rgba(0,240,255,0.3)}
        .logo-t{font-family:var(--mono);font-weight:700;font-size:.95rem;letter-spacing:3px;
            background:linear-gradient(135deg,var(--cyan),var(--violet));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
        .logo-v{font-family:var(--mono);font-size:.55rem;color:var(--t3);background:var(--glass);padding:2px 5px;border-radius:3px;border:1px solid var(--brd)}

        .top-nav{display:flex;gap:3px}
        .nbtn{font-family:var(--mono);font-size:.65rem;font-weight:500;color:var(--t3);padding:5px 12px;border-radius:var(--r-s);cursor:pointer;border:none;background:none;transition:.15s}
        .nbtn:hover{color:var(--t2);background:var(--glass)}
        .nbtn.on{color:var(--cyan);background:var(--cyan-d)}

        .top-r{display:flex;align-items:center;gap:8px}
        .sdot{width:5px;height:5px;border-radius:50%;background:var(--green);box-shadow:0 0 6px var(--green);animation:pul 2s ease-in-out infinite}
        @keyframes pul{0%,100%{opacity:1}50%{opacity:.3}}
        .slbl{font-family:var(--mono);font-size:.6rem;color:var(--t3);display:flex;align-items:center;gap:5px}

        /* LEFT SIDEBAR */
        .sl{background:rgba(10,14,23,0.6);backdrop-filter:blur(20px);border-right:1px solid var(--brd);display:flex;flex-direction:column;overflow:hidden}

        .pcard{margin:10px;padding:12px;background:linear-gradient(135deg,rgba(139,92,246,0.08),rgba(0,240,255,0.04));border:1px solid rgba(139,92,246,0.15);border-radius:var(--r-l)}
        .pcard-h{display:flex;justify-content:space-between;margin-bottom:6px}
        .prank{font-family:var(--mono);font-size:.58rem;font-weight:600;color:var(--violet);text-transform:uppercase;letter-spacing:1px}
        .pxpt{font-family:var(--mono);font-size:.55rem;color:var(--t3)}
        .xbar{width:100%;height:4px;background:var(--bg);border-radius:2px;overflow:hidden;margin-bottom:8px}
        .xfill{height:100%;background:linear-gradient(90deg,var(--violet),var(--cyan));border-radius:2px;transition:width 1s}
        .pstats{display:grid;grid-template-columns:1fr 1fr 1fr;gap:4px}
        .ps{text-align:center}
        .ps-v{font-family:var(--mono);font-size:.95rem;font-weight:700}
        .ps-l{font-size:.5rem;color:var(--t3);text-transform:uppercase;letter-spacing:.5px}

        .sscroll{flex:1;overflow-y:auto;scrollbar-width:thin;scrollbar-color:var(--bg3) transparent}
        .sscroll::-webkit-scrollbar{width:3px}
        .sscroll::-webkit-scrollbar-thumb{background:var(--bg3);border-radius:2px}

        .slabel{font-family:var(--mono);font-size:.55rem;font-weight:600;color:var(--t3);text-transform:uppercase;letter-spacing:2px;padding:8px 12px 4px;display:flex;justify-content:space-between}
        .scnt{font-size:.5rem;color:var(--cyan);background:var(--cyan-d);padding:1px 6px;border-radius:7px}

        .pi{display:flex;align-items:center;gap:8px;padding:7px 12px;cursor:pointer;transition:.15s;border-left:3px solid transparent}
        .pi:hover{background:var(--glass)}
        .pi.on{background:var(--cyan-d);border-left-color:var(--cyan)}
        .pi-ic{width:28px;height:28px;border-radius:6px;display:flex;align-items:center;justify-content:center;font-size:.75rem;flex-shrink:0}
        .pi-info{flex:1;min-width:0}
        .pi-name{font-size:.72rem;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
        .pi-meta{font-family:var(--mono);font-size:.55rem;color:var(--t3);display:flex;align-items:center;gap:4px;margin-top:1px}
        .dot{width:4px;height:4px;border-radius:50%}
        .dot-g{background:var(--green);box-shadow:0 0 4px var(--green)}
        .dot-y{background:var(--yellow)}
        .dot-m{background:var(--t3)}
        .pi-rev{font-family:var(--mono);font-size:.6rem;font-weight:600;color:var(--green);flex-shrink:0}

        .npbtn{margin:8px 10px;padding:8px;border:1px dashed var(--brd-a);border-radius:var(--r-m);background:none;color:var(--cyan);font-family:var(--mono);font-size:.65rem;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:5px;transition:.15s}
        .npbtn:hover{background:var(--cyan-d);border-style:solid}

        /* MAIN */
        .mn{overflow-y:auto;padding:14px;scrollbar-width:thin;scrollbar-color:var(--bg3) transparent}
        .mn::-webkit-scrollbar{width:3px}
        .mn::-webkit-scrollbar-thumb{background:var(--bg3);border-radius:2px}

        .vw{display:none}.vw.on{display:block}

        /* Weekly Mission */
        .wm{background:linear-gradient(135deg,rgba(0,240,255,0.04),rgba(139,92,246,0.04));border:1px solid var(--brd);border-radius:var(--r-xl);padding:18px;margin-bottom:14px;position:relative}
        .wm::before{content:'';position:absolute;top:0;left:0;right:0;height:1px;background:linear-gradient(90deg,transparent,var(--cyan),var(--violet),transparent)}
        .wm-top{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
        .wm-l{display:flex;align-items:center;gap:8px}
        .wm-badge{font-family:var(--mono);font-size:.5rem;font-weight:700;color:var(--bg);background:linear-gradient(135deg,var(--cyan),var(--violet));padding:2px 8px;border-radius:7px;text-transform:uppercase;letter-spacing:1px}
        .wm-name{font-size:.95rem;font-weight:700}
        .wm-timer{font-family:var(--mono);font-size:.7rem;color:var(--t3)}
        .wm-timer b{color:var(--cyan)}
        .wm-bw{margin-bottom:12px}
        .wm-bt{display:flex;justify-content:space-between;margin-bottom:5px}
        .wm-bl{font-family:var(--mono);font-size:.6rem;color:var(--t2)}
        .wm-bv{font-family:var(--mono);font-size:.6rem;color:var(--cyan);font-weight:600}
        .wm-bar{width:100%;height:6px;background:var(--bg);border-radius:3px;overflow:hidden}
        .wm-bf{height:100%;background:linear-gradient(90deg,var(--cyan),var(--violet));border-radius:3px;transition:width 1s}
        .mls{display:flex;gap:6px}
        .ml{flex:1;padding:6px;background:var(--glass);border:1px solid var(--brd);border-radius:var(--r-m);text-align:center}
        .ml.done{border-color:rgba(52,211,153,0.3);background:var(--green-d)}
        .ml.cur{border-color:var(--brd-a);background:var(--cyan-d)}
        .ml-i{font-size:.9rem}
        .ml-t{font-size:.55rem;color:var(--t3);margin-top:2px}
        .ml.done .ml-t{color:var(--green)}

        /* Stats */
        .sgrid{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-bottom:14px}
        .sc{background:var(--card);border:1px solid var(--brd);border-radius:var(--r-l);padding:12px;position:relative;overflow:hidden;transition:.2s}
        .sc:hover{border-color:var(--brd-a);transform:translateY(-1px)}
        .sc::before{content:'';position:absolute;top:0;left:0;right:0;height:2px}
        .sc:nth-child(1)::before{background:var(--cyan)}.sc:nth-child(2)::before{background:var(--violet)}
        .sc:nth-child(3)::before{background:var(--green)}.sc:nth-child(4)::before{background:var(--pink)}
        .sc-t{display:flex;justify-content:space-between;margin-bottom:4px}
        .sc-l{font-family:var(--mono);font-size:.55rem;color:var(--t3);text-transform:uppercase;letter-spacing:.5px}
        .sc-tr{font-family:var(--mono);font-size:.55rem;font-weight:600;color:var(--green)}
        .sc-v{font-family:var(--mono);font-size:1.3rem;font-weight:800}
        .sc:nth-child(1) .sc-v{color:var(--cyan)}.sc:nth-child(2) .sc-v{color:var(--violet)}
        .sc:nth-child(3) .sc-v{color:var(--green)}.sc:nth-child(4) .sc-v{color:var(--pink)}
        .sc-s{font-size:.6rem;color:var(--t3)}

        /* Opp cards */
        .sh{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
        .st{font-size:.9rem;font-weight:700;display:flex;align-items:center;gap:7px}
        .si{width:24px;height:24px;border-radius:5px;display:flex;align-items:center;justify-content:center;font-size:.75rem}
        .fbs{display:flex;gap:3px}
        .fb{font-family:var(--mono);font-size:.55rem;padding:3px 8px;border-radius:var(--r-s);border:1px solid var(--brd);background:var(--glass);color:var(--t3);cursor:pointer;transition:.15s}
        .fb:hover,.fb.on{border-color:var(--brd-a);color:var(--cyan);background:var(--cyan-d)}

        .og{display:grid;grid-template-columns:repeat(2,1fr);gap:8px;margin-bottom:16px}
        .oc{background:var(--card);backdrop-filter:blur(12px);border:1px solid var(--brd);border-radius:var(--r-l);padding:14px;cursor:pointer;transition:.25s}
        .oc:hover{border-color:var(--brd-a);transform:translateY(-2px);box-shadow:0 0 16px rgba(0,240,255,0.08)}
        .oc-top{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:8px}
        .oc-src{display:flex;align-items:center;gap:4px}
        .oc-si{width:18px;height:18px;border-radius:4px;display:flex;align-items:center;justify-content:center;font-size:.6rem;color:#fff}
        .oc-st{font-family:var(--mono);font-size:.55rem;color:var(--t3)}
        .oc-sc{font-family:var(--mono);font-size:.6rem;font-weight:700;padding:2px 6px;border-radius:5px}
        .oc-sc.hi{color:var(--green);background:var(--green-d)}
        .oc-sc.md{color:var(--yellow);background:var(--yellow-d)}
        .oc-ti{font-size:.8rem;font-weight:600;margin-bottom:5px;line-height:1.4}
        .oc-desc{font-size:.65rem;color:var(--t2);line-height:1.5;margin-bottom:8px}
        .oc-tags{display:flex;flex-wrap:wrap;gap:3px;margin-bottom:8px}
        .oc-tag{font-family:var(--mono);font-size:.5rem;padding:2px 6px;border-radius:4px;background:var(--bg);color:var(--t3);border:1px solid var(--brd)}
        .oc-ms{display:flex;gap:12px;padding-top:8px;border-top:1px solid var(--brd)}
        .oc-mv{font-family:var(--mono);font-size:.7rem;font-weight:700}
        .oc-ml{font-size:.5rem;color:var(--t3);text-transform:uppercase}

        /* Live feed */
        .lf{background:var(--card);border:1px solid var(--brd);border-radius:var(--r-l);padding:12px}
        .lf-top{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
        .lf-t{font-family:var(--mono);font-size:.65rem;color:var(--t2);text-transform:uppercase;letter-spacing:1px}
        .live{display:flex;align-items:center;gap:4px;font-family:var(--mono);font-size:.5rem;color:var(--red);font-weight:700}
        .ldot{width:5px;height:5px;border-radius:50%;background:var(--red);animation:pul 1s ease-in-out infinite}
        .fi{display:flex;align-items:center;gap:7px;padding:7px 8px;background:var(--glass);border-radius:var(--r-m);margin-bottom:4px;cursor:pointer;transition:.15s}
        .fi:hover{background:rgba(26,34,53,0.8)}
        .fi-ic{font-size:.8rem;width:22px;height:22px;display:flex;align-items:center;justify-content:center;background:var(--bg);border-radius:4px;flex-shrink:0}
        .fi-c{flex:1;min-width:0}
        .fi-tx{font-size:.65rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
        .fi-m{font-family:var(--mono);font-size:.5rem;color:var(--t3)}
        .fi-sc{font-family:var(--mono);font-size:.6rem;font-weight:700;color:var(--green);flex-shrink:0}

        /* CHAT */
        .cc{display:flex;flex-direction:column;height:calc(100vh - 50px)}
        .cms{flex:1;overflow-y:auto;padding:14px;scrollbar-width:thin;scrollbar-color:var(--bg3) transparent}
        .cms::-webkit-scrollbar{width:3px}
        .cms::-webkit-scrollbar-thumb{background:var(--bg3);border-radius:2px}

        .msg{display:flex;gap:8px;margin-bottom:14px;animation:mi .3s ease}
        @keyframes mi{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}
        .m-av{width:30px;height:30px;border-radius:7px;display:flex;align-items:center;justify-content:center;font-size:.75rem;flex-shrink:0}
        .m-av.u{background:linear-gradient(135deg,var(--violet),var(--pink))}
        .m-av.j{background:linear-gradient(135deg,var(--cyan),var(--violet));box-shadow:0 0 8px rgba(0,240,255,0.2)}
        .m-body{flex:1;min-width:0}
        .m-name{font-family:var(--mono);font-size:.6rem;font-weight:600;margin-bottom:3px}
        .m-name.un{color:var(--violet)}.m-name.jn{color:var(--cyan)}
        .m-text{font-size:.8rem;line-height:1.6;background:var(--card);border:1px solid var(--brd);border-radius:3px var(--r-l) var(--r-l) var(--r-l);padding:10px 14px;white-space:pre-wrap;word-break:break-word}
        .msg.usr .m-text{background:var(--violet-d);border-color:rgba(139,92,246,0.15);border-radius:var(--r-l) 3px var(--r-l) var(--r-l)}
        .m-time{font-family:var(--mono);font-size:.5rem;color:var(--t3);margin-top:3px}
        .m-tok{font-family:var(--mono);font-size:.45rem;color:var(--t3);margin-top:1px}

        .typing{display:none;align-items:center;gap:4px;padding:6px 14px;font-family:var(--mono);font-size:.65rem;color:var(--cyan)}
        .typing.on{display:flex}
        .td{width:4px;height:4px;border-radius:50%;background:var(--cyan);animation:tdot 1.4s ease-in-out infinite}
        .td:nth-child(2){animation-delay:.2s}.td:nth-child(3){animation-delay:.4s}
        @keyframes tdot{0%,60%,100%{opacity:.3;transform:translateY(0)}30%{opacity:1;transform:translateY(-3px)}}

        .cia{padding:10px 14px;border-top:1px solid var(--brd);background:rgba(10,14,23,0.8);backdrop-filter:blur(20px)}
        .ciw{display:flex;gap:6px}
        .cinp{flex:1;padding:9px 12px;background:var(--bg3);border:1px solid var(--brd);border-radius:var(--r-m);color:var(--t1);font-family:var(--sans);font-size:.8rem;resize:none;outline:none;transition:border .15s}
        .cinp:focus{border-color:var(--brd-a)}
        .cinp::placeholder{color:var(--t3)}
        .sbtn{padding:9px 18px;background:linear-gradient(135deg,var(--cyan),var(--violet));border:none;border-radius:var(--r-m);color:var(--bg);font-family:var(--mono);font-size:.7rem;font-weight:700;cursor:pointer;transition:.15s;letter-spacing:1px}
        .sbtn:hover{transform:translateY(-1px);box-shadow:0 0 16px rgba(0,240,255,0.3)}
        .sbtn:disabled{opacity:.4;cursor:not-allowed;transform:none;box-shadow:none}
        .chint{font-family:var(--mono);font-size:.5rem;color:var(--t3);margin-top:4px;text-align:center}

        /* RIGHT SIDEBAR */
        .sr{background:rgba(10,14,23,0.6);backdrop-filter:blur(20px);border-left:1px solid var(--brd);display:flex;flex-direction:column;overflow:hidden}
        .sr-s{flex:1;overflow-y:auto;padding:12px;scrollbar-width:thin;scrollbar-color:var(--bg3) transparent}
        .sr-s::-webkit-scrollbar{width:3px}
        .sr-s::-webkit-scrollbar-thumb{background:var(--bg3);border-radius:2px}

        .mchart{background:var(--card);border:1px solid var(--brd);border-radius:var(--r-l);padding:12px;margin-bottom:12px}
        .mch-t{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
        .mch-tl{font-family:var(--mono);font-size:.6rem;color:var(--t2);text-transform:uppercase;letter-spacing:1px}
        .mch-v{font-family:var(--mono);font-size:1rem;font-weight:800;color:var(--green)}
        .cbars{display:flex;align-items:flex-end;gap:2px;height:45px}
        .cb{flex:1;border-radius:2px 2px 0 0;cursor:pointer;transition:opacity .15s}
        .cb:hover{opacity:.7}
        .clabels{display:flex;gap:2px;margin-top:3px}
        .cl{flex:1;text-align:center;font-family:var(--mono);font-size:.4rem;color:var(--t3)}

        .qsec{margin-bottom:14px}
        .qsec-t{font-family:var(--mono);font-size:.55rem;font-weight:600;color:var(--t3);text-transform:uppercase;letter-spacing:2px;margin-bottom:8px;display:flex;align-items:center;gap:5px}

        .qc{background:var(--card);border:1px solid var(--brd);border-radius:var(--r-l);padding:12px;margin-bottom:6px;transition:border .15s}
        .qc:hover{border-color:var(--brd-a)}
        .qc-top{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}
        .qp{font-family:var(--mono);font-size:.45rem;font-weight:700;padding:2px 6px;border-radius:4px;text-transform:uppercase;letter-spacing:.5px}
        .qp.urg{color:var(--red);background:var(--red-d)}
        .qp.nrm{color:var(--cyan);background:var(--cyan-d)}
        .qp.low{color:var(--t3);background:var(--glass)}
        .qxp{font-family:var(--mono);font-size:.55rem;color:var(--violet);font-weight:600}
        .qn{font-size:.75rem;font-weight:600;margin-bottom:6px}
        .ql{list-style:none}
        .qi{display:flex;align-items:center;gap:6px;padding:4px 0;cursor:pointer}
        .qch{width:14px;height:14px;border:2px solid var(--t3);border-radius:3px;display:flex;align-items:center;justify-content:center;font-size:.5rem;flex-shrink:0;transition:.15s}
        .qi.dn .qch{background:var(--green);border-color:var(--green);color:var(--bg)}
        .qi:hover .qch{border-color:var(--cyan)}
        .qtx{font-size:.65rem;color:var(--t2);transition:.15s}
        .qi.dn .qtx{color:var(--t3);text-decoration:line-through}
        .qprog{display:flex;align-items:center;gap:5px;margin-top:6px;padding-top:6px;border-top:1px solid var(--brd)}
        .qpb{flex:1;height:3px;background:var(--bg);border-radius:2px;overflow:hidden}
        .qpf{height:100%;border-radius:2px;transition:width .4s}
        .qpt{font-family:var(--mono);font-size:.55rem;color:var(--t3)}

        .ag{display:grid;grid-template-columns:repeat(3,1fr);gap:5px;margin-bottom:12px}
        .ach{aspect-ratio:1;border-radius:var(--r-m);border:1px solid var(--brd);background:var(--glass);display:flex;flex-direction:column;align-items:center;justify-content:center;gap:2px;cursor:pointer;transition:.15s}
        .ach:hover{border-color:var(--brd-a);transform:scale(1.05)}
        .ach.ul{background:linear-gradient(135deg,rgba(0,240,255,0.06),rgba(139,92,246,0.06));border-color:rgba(0,240,255,0.15)}
        .ach.lk{opacity:.35}
        .ach-i{font-size:1rem}
        .ach-n{font-size:.45rem;color:var(--t3);text-align:center}
        .ach.ul .ach-n{color:var(--t2)}

        .tl{padding-left:14px;position:relative}
        .tl::before{content:'';position:absolute;left:4px;top:0;bottom:0;width:1px;background:linear-gradient(180deg,var(--brd-a),transparent)}
        .tli{position:relative;padding-bottom:10px}
        .tli::before{content:'';position:absolute;left:-12px;top:3px;width:6px;height:6px;border-radius:50%;border:2px solid var(--cyan);background:var(--bg)}
        .tli.dn::before{background:var(--green);border-color:var(--green)}
        .tl-tm{font-family:var(--mono);font-size:.5rem;color:var(--t3)}
        .tl-tx{font-size:.65rem;color:var(--t2);line-height:1.4}

        .xpp{position:fixed;color:var(--violet);font-family:var(--mono);font-size:.75rem;font-weight:700;pointer-events:none;z-index:10000;animation:xpu 1s ease forwards}
        @keyframes xpu{0%{opacity:1;transform:translateY(0)}100%{opacity:0;transform:translateY(-20px)}}

        /* Modal */
        .mo{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.7);backdrop-filter:blur(8px);z-index:5000;justify-content:center;align-items:center}
        .mo.on{display:flex}
        .mod{background:var(--bg2);border:1px solid var(--brd);border-radius:var(--r-xl);padding:20px;width:90%;max-width:500px;animation:modin .3s ease}
        @keyframes modin{from{opacity:0;transform:scale(.95) translateY(8px)}to{opacity:1;transform:scale(1) translateY(0)}}
        .mod-t{font-size:1rem;font-weight:700;margin-bottom:14px;display:flex;align-items:center;gap:7px}
        .mod-f{margin-bottom:10px}
        .mod-l{font-family:var(--mono);font-size:.6rem;color:var(--t3);text-transform:uppercase;letter-spacing:1px;margin-bottom:3px}
        .mod-i,.mod-ta{width:100%;padding:8px 10px;background:var(--bg3);border:1px solid var(--brd);border-radius:var(--r-m);color:var(--t1);font-family:var(--sans);font-size:.8rem;outline:none;transition:border .15s}
        .mod-i:focus,.mod-ta:focus{border-color:var(--brd-a)}
        .mod-ta{resize:vertical;min-height:60px}
        .mod-acts{display:flex;gap:6px;justify-content:flex-end;margin-top:14px}
        .mbtn{padding:7px 16px;border-radius:var(--r-m);font-family:var(--mono);font-size:.7rem;font-weight:600;cursor:pointer;border:none;transition:.15s}
        .mbtn.pri{background:linear-gradient(135deg,var(--cyan),var(--violet));color:var(--bg)}
        .mbtn.pri:hover{box-shadow:0 0 12px rgba(0,240,255,0.3)}
        .mbtn.sec{background:var(--glass);color:var(--t2);border:1px solid var(--brd)}
        .mbtn.sec:hover{border-color:var(--brd-a)}

        .mod-res{font-size:.8rem;line-height:1.6;white-space:pre-wrap;max-height:55vh;overflow-y:auto;margin-top:10px;padding:12px;background:var(--bg);border-radius:var(--r-m);border:1px solid var(--brd);scrollbar-width:thin;scrollbar-color:var(--bg3) transparent}

        @media(max-width:1100px){.app{grid-template-columns:220px 1fr 280px}}
        @media(max-width:850px){.app{grid-template-columns:1fr}.sl,.sr{display:none}.og{grid-template-columns:1fr}.sgrid{grid-template-columns:repeat(2,1fr)}}
    </style>
</head>
<body>
<div class="grid-bg"></div>
<div class="scan"></div>

<div class="app">
    <!-- TOPBAR -->
    <header class="top">
        <div class="logo">
            <div class="logo-i">J</div>
            <span class="logo-t">JARVIS</span>
            <span class="logo-v">v2.0</span>
        </div>
        <nav class="top-nav">
            <button class="nbtn on" data-v="dash">üéØ –¶–µ–Ω—Ç—Ä</button>
            <button class="nbtn" data-v="chat">üí¨ –ß–∞—Ç</button>
            <button class="nbtn" data-v="recon">üîç –†–∞–∑–≤–µ–¥–∫–∞</button>
        </nav>
        <div class="top-r">
            <div class="slbl"><div class="sdot"></div>Online</div>
        </div>
    </header>

    <!-- LEFT SIDEBAR -->
    <aside class="sl">
        <div class="pcard">
            <div class="pcard-h">
                <span class="prank" id="pRank">‚ö° –£—Ä.1 ‚Äî –ù–æ–≤–∏—á–æ–∫</span>
                <span class="pxpt" id="pXpT">0/1000 XP</span>
            </div>
            <div class="xbar"><div class="xfill" id="xFill" style="width:0%"></div></div>
            <div class="pstats">
                <div class="ps"><div class="ps-v" id="sProj">0</div><div class="ps-l">–ü—Ä–æ–µ–∫—Ç—ã</div></div>
                <div class="ps"><div class="ps-v" id="sQuest">0</div><div class="ps-l">–ö–≤–µ—Å—Ç—ã</div></div>
                <div class="ps"><div class="ps-v" id="sStreak">0</div><div class="ps-l">üî•</div></div>
            </div>
        </div>
        <div class="sscroll">
            <div class="slabel">–ü—Ä–æ–µ–∫—Ç—ã <span class="scnt" id="pCnt">0</span></div>
            <div id="projList"></div>
            <div class="slabel" style="margin-top:6px">–ù–∏—à–∏ <span class="scnt" id="oCnt">0</span></div>
            <div id="nicheList"></div>
        </div>
        <button class="npbtn" onclick="openModal()">‚ûï –ù–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç</button>
    </aside>

    <!-- MAIN -->
    <main class="mn">

        <!-- DASHBOARD -->
        <div class="vw on" id="v-dash">
            <div class="wm">
                <div class="wm-top">
                    <div class="wm-l">
                        <span class="wm-badge">üéØ –ú–∏—Å—Å–∏—è –Ω–µ–¥–µ–ª–∏</span>
                        <span class="wm-name" id="wmName">–°–æ–∑–¥–∞–π –ø–µ—Ä–≤—ã–π –ø—Ä–æ–µ–∫—Ç</span>
                    </div>
                    <div class="wm-timer">‚è± <b id="wmTimer">‚Äî</b></div>
                </div>
                <div class="wm-bw">
                    <div class="wm-bt"><span class="wm-bl">–ü—Ä–æ–≥—Ä–µ—Å—Å</span><span class="wm-bv" id="wmPct">0%</span></div>
                    <div class="wm-bar"><div class="wm-bf" id="wmFill" style="width:0%"></div></div>
                </div>
                <div class="mls">
                    <div class="ml cur"><div class="ml-i">üîÑ</div><div class="ml-t">–ò–¥–µ—è</div></div>
                    <div class="ml"><div class="ml-i">‚è≥</div><div class="ml-t">–í–∞–ª–∏–¥–∞—Ü–∏—è</div></div>
                    <div class="ml"><div class="ml-i">üîí</div><div class="ml-t">MVP</div></div>
                    <div class="ml"><div class="ml-i">üîí</div><div class="ml-t">–ó–∞–ø—É—Å–∫</div></div>
                    <div class="ml"><div class="ml-i">üîí</div><div class="ml-t">–†–æ—Å—Ç</div></div>
                </div>
            </div>

            <div class="sgrid">
                <div class="sc"><div class="sc-t"><span class="sc-l">–ü—Ä–æ–µ–∫—Ç—ã</span><span class="sc-tr" id="trP">‚Äî</span></div><div class="sc-v" id="dProj">0</div><div class="sc-s">–∞–∫—Ç–∏–≤–Ω—ã—Ö</div></div>
                <div class="sc"><div class="sc-t"><span class="sc-l">–ù–∏—à–∏</span><span class="sc-tr" id="trO">‚Äî</span></div><div class="sc-v" id="dOpp">0</div><div class="sc-s">–Ω–∞–π–¥–µ–Ω–æ</div></div>
                <div class="sc"><div class="sc-t"><span class="sc-l">MRR</span><span class="sc-tr">‚Üë</span></div><div class="sc-v" id="dMRR">$0</div><div class="sc-s">–¥–æ—Ö–æ–¥</div></div>
                <div class="sc"><div class="sc-t"><span class="sc-l">XP</span><span class="sc-tr">‚Üë</span></div><div class="sc-v" id="dXP">0</div><div class="sc-s">–Ω–µ–¥–µ–ª—è</div></div>
            </div>

            <div class="sh">
                <div class="st"><div class="si" style="background:var(--cyan-d);color:var(--cyan)">üîç</div>–†—ã–Ω–æ—á–Ω–∞—è —Ä–∞–∑–≤–µ–¥–∫–∞</div>
                <div class="fbs">
                    <button class="fb on">–í—Å–µ</button>
                    <button class="fb">Reddit</button>
                    <button class="fb">YouTube</button>
                    <button class="fb">Google</button>
                </div>
            </div>

            <div class="og" id="oppGrid">
                <div class="oc" onclick="analyzeNiche('–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –¥–ª—è —Ñ—Ä–∏–ª–∞–Ω—Å–µ—Ä–æ–≤')">
                    <div class="oc-top"><div class="oc-src"><div class="oc-si" style="background:#FF4500">R</div><span class="oc-st">Reddit</span></div><span class="oc-sc hi">92%</span></div>
                    <div class="oc-ti">¬´–ù–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ –¥–ª—è —Ñ—Ä–∏–ª–∞–Ω—Å–µ—Ä–æ–≤¬ª</div>
                    <div class="oc-desc">478 –∞–ø–≤–æ—É—Ç–æ–≤. –¢—Ä–µ–∫–∞–µ—Ç –¥–æ—Ö–æ–¥ –∏ –≤—Ä–µ–º—è.</div>
                    <div class="oc-tags"><span class="oc-tag">SaaS</span><span class="oc-tag">$15-30/–º–µ—Å</span></div>
                    <div class="oc-ms"><div><span class="oc-mv">$2.3M</span><br><span class="oc-ml">TAM</span></div><div><span class="oc-mv">–ù–∏–∑–∫–∞—è</span><br><span class="oc-ml">–ö–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è</span></div><div><span class="oc-mv">2 –Ω–µ–¥</span><br><span class="oc-ml">MVP</span></div></div>
                </div>
                <div class="oc" onclick="analyzeNiche('–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å—É–±—Ç–∏—Ç—Ä–æ–≤ –¥–ª—è –≤–∏–¥–µ–æ')">
                    <div class="oc-top"><div class="oc-src"><div class="oc-si" style="background:#FF0000">‚ñ∂</div><span class="oc-st">YouTube</span></div><span class="oc-sc hi">88%</span></div>
                    <div class="oc-ti">¬´–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å—É–±—Ç–∏—Ç—Ä—ã –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —è–∑—ã–∫–∞—Ö¬ª</div>
                    <div class="oc-desc">340+ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤. –ü–µ—Ä–µ–≤–æ–¥ –∏ –æ–∑–≤—É—á–∫–∞.</div>
                    <div class="oc-tags"><span class="oc-tag">–ö–æ–Ω—Ç–µ–Ω—Ç</span><span class="oc-tag">$29-99/–º–µ—Å</span></div>
                    <div class="oc-ms"><div><span class="oc-mv">$5.1M</span><br><span class="oc-ml">TAM</span></div><div><span class="oc-mv">–°—Ä–µ–¥–Ω—è—è</span><br><span class="oc-ml">–ö–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è</span></div><div><span class="oc-mv">3 –Ω–µ–¥</span><br><span class="oc-ml">MVP</span></div></div>
                </div>
                <div class="oc" onclick="analyzeNiche('–ü—Ä–æ—Å—Ç–∞—è CRM –¥–ª—è –º–∞–ª–æ–≥–æ –±–∏–∑–Ω–µ—Å–∞')">
                    <div class="oc-top"><div class="oc-src"><div class="oc-si" style="background:#1877F2">f</div><span class="oc-st">Facebook</span></div><span class="oc-sc md">76%</span></div>
                    <div class="oc-ti">¬´CRM –±–µ–∑ –¥–µ—Å—è—Ç–∫–æ–≤ –Ω–µ–Ω—É–∂–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π¬ª</div>
                    <div class="oc-desc">–ì—Ä—É–ø–ø–∞ 45–ö –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª–µ–π.</div>
                    <div class="oc-tags"><span class="oc-tag">CRM</span><span class="oc-tag">$19/–º–µ—Å</span></div>
                    <div class="oc-ms"><div><span class="oc-mv">$8.7M</span><br><span class="oc-ml">TAM</span></div><div><span class="oc-mv">–í—ã—Å–æ–∫–∞—è</span><br><span class="oc-ml">–ö–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è</span></div><div><span class="oc-mv">4 –Ω–µ–¥</span><br><span class="oc-ml">MVP</span></div></div>
                </div>
                <div class="oc" onclick="analyzeNiche('–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∏–Ω–≤–æ–π—Å–æ–≤ –¥–ª—è –ø–æ–¥—Ä—è–¥—á–∏–∫–æ–≤')">
                    <div class="oc-top"><div class="oc-src"><div class="oc-si" style="background:#4285F4">G</div><span class="oc-st">Google</span></div><span class="oc-sc hi">91%</span></div>
                    <div class="oc-ti">¬´Invoice generator for contractors¬ª +340%</div>
                    <div class="oc-desc">–¢–æ–ø-3 —Å –ø–ª–æ—Ö–∏–º UX, –Ω–µ—Ç –º–æ–±–∏–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏.</div>
                    <div class="oc-tags"><span class="oc-tag">–§–∏–Ω—Ç–µ—Ö</span><span class="oc-tag">$9-25/–º–µ—Å</span></div>
                    <div class="oc-ms"><div><span class="oc-mv">$3.8M</span><br><span class="oc-ml">TAM</span></div><div><span class="oc-mv">–ù–∏–∑–∫–∞—è</span><br><span class="oc-ml">–ö–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è</span></div><div><span class="oc-mv">1.5 –Ω–µ–¥</span><br><span class="oc-ml">MVP</span></div></div>
                </div>
            </div>

            <div class="lf">
                <div class="lf-top"><span class="lf-t">üì° –õ–µ–Ω—Ç–∞</span><div class="live"><div class="ldot"></div>LIVE</div></div>
                <div class="fi"><div class="fi-ic">üî¥</div><div class="fi-c"><div class="fi-tx">r/SaaS: ¬´–ü–ª–∞—Ç–∏–ª $200/–º–µ—Å –∑–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∑–∞ $20¬ª</div><div class="fi-m">2 –º–∏–Ω –Ω–∞–∑–∞–¥</div></div><div class="fi-sc">+87</div></div>
                <div class="fi"><div class="fi-ic">üü¢</div><div class="fi-c"><div class="fi-tx">Google: ¬´budget app for couples¬ª +180%</div><div class="fi-m">15 –º–∏–Ω –Ω–∞–∑–∞–¥</div></div><div class="fi-sc">+92</div></div>
                <div class="fi"><div class="fi-ic">üîµ</div><div class="fi-c"><div class="fi-tx">Facebook: –ó–∞–ø–∏—Å—å –≤ –±–∞—Ä–±–µ—Ä—à–æ–ø—ã ‚Äî 1.2K —Ä–µ–∞–∫—Ü–∏–π</div><div class="fi-m">23 –º–∏–Ω –Ω–∞–∑–∞–¥</div></div><div class="fi-sc">+64</div></div>
            </div>
        </div>

        <!-- CHAT -->
        <div class="vw" id="v-chat">
            <div class="cc">
                <div class="cms" id="chatMsgs">
                    <div class="msg"><div class="m-av j">J</div><div class="m-body"><div class="m-name jn">JARVIS 2.0</div><div class="m-text">–ü—Ä–∏–≤–µ—Ç, –∫–æ–º–∞–Ω–¥–∏—Ä! ü§ñ

–Ø ‚Äî JARVIS 2.0. –í–æ—Ç —á—Ç–æ —É–º–µ—é:

üîç ¬´–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –Ω–∏—à—É: [–æ–ø–∏—Å–∞–Ω–∏–µ]¬ª
üìã ¬´–†–∞–∑–±–µ–π –Ω–∞ —Å–ø—Ä–∏–Ω—Ç—ã: [–ø—Ä–æ–µ–∫—Ç]¬ª
üí° ¬´–ö–∞–∫–∏–µ –Ω–∏—à–∏ —Å–µ–π—á–∞—Å —Ä–∞—Å—Ç—É—Ç?¬ª
üìä ¬´–°–æ—Å—Ç–∞–≤—å –ø–ª–∞–Ω –¥–ª—è: [–∏–¥–µ—è]¬ª

–ß—Ç–æ —Å—Ç—Ä–æ–∏–º?</div><div class="m-time">–°–µ–π—á–∞—Å</div></div></div>
                </div>
                <div class="typing" id="typing"><div class="td"></div><div class="td"></div><div class="td"></div><span style="margin-left:5px">JARVIS –¥—É–º–∞–µ—Ç...</span></div>
                <div class="cia">
                    <div class="ciw">
                        <textarea class="cinp" id="chatInp" placeholder="–°–ø—Ä–æ—Å–∏ JARVIS..." rows="1" onkeydown="chatKey(event)"></textarea>
                        <button class="sbtn" id="sendBtn" onclick="send()">SEND</button>
                    </div>
                    <div class="chint">Enter ‚Äî –æ—Ç–ø—Ä–∞–≤–∏—Ç—å ¬∑ Shift+Enter ‚Äî —Å—Ç—Ä–æ–∫–∞ ¬∑ Claude API</div>
                </div>
            </div>
        </div>

        <!-- RECON -->
        <div class="vw" id="v-recon">
            <div style="text-align:center;padding:50px 16px">
                <div style="font-size:2.5rem;margin-bottom:12px">üîç</div>
                <h2 style="margin-bottom:6px">–ú–æ–¥—É–ª—å —Ä–∞–∑–≤–µ–¥–∫–∏</h2>
                <p style="color:var(--t2);max-width:380px;margin:0 auto;font-size:.85rem">
                    –ü–æ–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–π —á–∞—Ç ‚Äî —Å–ø—Ä–æ—Å–∏ JARVIS<br>¬´–ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –Ω–∏—à—É: [—Ç–≤–æ—è –∏–¥–µ—è]¬ª
                </p>
            </div>
        </div>
    </main>

    <!-- RIGHT SIDEBAR -->
    <aside class="sr">
        <div class="sr-s">
            <div class="mchart">
                <div class="mch-t"><span class="mch-tl">–î–æ—Ö–æ–¥ 7–¥</span><span class="mch-v">$4,280</span></div>
                <div class="cbars" id="cBars"></div>
                <div class="clabels" id="cLabels"></div>
            </div>

            <div class="qsec">
                <div class="qsec-t">‚öîÔ∏è –ö–≤–µ—Å—Ç—ã</div>
                <div id="questList">
                    <div class="qc">
                        <div class="qc-top"><span class="qp urg">üî• –°—Ä–æ—á–Ω–æ</span><span class="qxp">+250 XP</span></div>
                        <div class="qn">–ó–∞–ø—É—Å—Ç–∏—Ç—å –ª–µ–Ω–¥–∏–Ω–≥</div>
                        <ul class="ql">
                            <li class="qi dn" onclick="togQ(this)"><div class="qch">‚úì</div><span class="qtx">–ö–æ–ø–∏—Ä–∞–π—Ç</span></li>
                            <li class="qi dn" onclick="togQ(this)"><div class="qch">‚úì</div><span class="qtx">–í—ë—Ä—Å—Ç–∫–∞</span></li>
                            <li class="qi" onclick="togQ(this)"><div class="qch"></div><span class="qtx">Stripe –ø–ª–∞—Ç–µ–∂–∏</span></li>
                            <li class="qi" onclick="togQ(this)"><div class="qch"></div><span class="qtx">A/B —Ç–µ—Å—Ç</span></li>
                        </ul>
                        <div class="qprog"><div class="qpb"><div class="qpf" style="width:50%;background:linear-gradient(90deg,var(--green),var(--cyan))"></div></div><span class="qpt">2/4</span></div>
                    </div>
                    <div class="qc">
                        <div class="qc-top"><span class="qp nrm">üìã –û–±—ã—á–Ω—ã–π</span><span class="qxp">+150 XP</span></div>
                        <div class="qn">–í–∞–ª–∏–¥–∞—Ü–∏—è: –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫</div>
                        <ul class="ql">
                            <li class="qi dn" onclick="togQ(this)"><div class="qch">‚úì</div><span class="qtx">50 –æ—Ç–≤–µ—Ç–æ–≤ –æ–ø—Ä–æ—Å–∞</span></li>
                            <li class="qi" onclick="togQ(this)"><div class="qch"></div><span class="qtx">5 –∏–Ω—Ç–µ—Ä–≤—å—é</span></li>
                            <li class="qi" onclick="togQ(this)"><div class="qch"></div><span class="qtx">Lean Canvas</span></li>
                        </ul>
                        <div class="qprog"><div class="qpb"><div class="qpf" style="width:33%;background:linear-gradient(90deg,var(--violet),var(--cyan))"></div></div><span class="qpt">1/3</span></div>
                    </div>
                </div>
            </div>

            <div class="qsec">
                <div class="qsec-t">üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</div>
                <div class="ag">
                    <div class="ach ul"><div class="ach-i">üí∞</div><div class="ach-n">–ü–µ—Ä–≤—ã–π $</div></div>
                    <div class="ach ul"><div class="ach-i">üöÄ</div><div class="ach-n">10 –ø—Ä–æ–µ–∫—Ç–æ–≤</div></div>
                    <div class="ach ul"><div class="ach-i">üìà</div><div class="ach-n">$1K MRR</div></div>
                    <div class="ach ul"><div class="ach-i">‚ö°</div><div class="ach-n">100 –ø—Ä–æ–µ–∫—Ç–æ–≤</div></div>
                    <div class="ach ul"><div class="ach-i">üî•</div><div class="ach-n">30–¥ —Å–µ—Ä–∏—è</div></div>
                    <div class="ach lk"><div class="ach-i">üíé</div><div class="ach-n">$10K</div></div>
                    <div class="ach lk"><div class="ach-i">üëë</div><div class="ach-n">$50K</div></div>
                    <div class="ach lk"><div class="ach-i">üåç</div><div class="ach-n">500 –ø—Ä–æ–µ–∫—Ç–æ–≤</div></div>
                    <div class="ach lk"><div class="ach-i">üè∞</div><div class="ach-n">$100K</div></div>
                </div>
            </div>

            <div class="qsec">
                <div class="qsec-t">üìã –°–µ–≥–æ–¥–Ω—è</div>
                <div class="tl" id="timeline">
                    <div class="tli dn"><div class="tl-tm">now</div><div class="tl-tx">JARVIS 2.0 –∑–∞–ø—É—â–µ–Ω</div></div>
                </div>
            </div>
        </div>
    </aside>
</div>

<!-- MODALS -->
<div class="mo" id="mNew">
    <div class="mod">
        <div class="mod-t">üöÄ –ù–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç</div>
        <div class="mod-f"><div class="mod-l">–ù–∞–∑–≤–∞–Ω–∏–µ</div><input class="mod-i" id="nName" placeholder="SaaS –¥–ª—è —Ñ—Ä–∏–ª–∞–Ω—Å–µ—Ä–æ–≤..."></div>
        <div class="mod-f"><div class="mod-l">–û–ø–∏—Å–∞–Ω–∏–µ</div><textarea class="mod-ta" id="nDesc" placeholder="–ß—Ç–æ –∑–∞ –ø—Ä–æ–¥—É–∫—Ç..."></textarea></div>
        <div class="mod-f"><div class="mod-l">–ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è</div><input class="mod-i" id="nMon" placeholder="$19/–º–µ—Å –ø–æ–¥–ø–∏—Å–∫–∞"></div>
        <div class="mod-acts">
            <button class="mbtn sec" onclick="closeModal()">–û—Ç–º–µ–Ω–∞</button>
            <button class="mbtn pri" onclick="createProj()">–°–æ–∑–¥–∞—Ç—å + —Å–ø—Ä–∏–Ω—Ç—ã</button>
        </div>
    </div>
</div>

<div class="mo" id="mNiche">
    <div class="mod" style="max-width:580px">
        <div class="mod-t">üîç –ê–Ω–∞–ª–∏–∑ –Ω–∏—à–∏</div>
        <div class="mod-res" id="nicheRes">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        <div class="mod-acts">
            <button class="mbtn sec" onclick="document.getElementById('mNiche').classList.remove('on')">–ó–∞–∫—Ä—ã—Ç—å</button>
            <button class="mbtn pri" onclick="nicheToProj()">‚Üí –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç</button>
        </div>
    </div>
</div>

<script>
// === STATE ===
const S={hist:[],niche:'',xp:0,lvl:1,xpN:1000,rank:'–ù–æ–≤–∏—á–æ–∫'};
const RANKS=['–ù–æ–≤–∏—á–æ–∫','–°—Ç–∞–∂—ë—Ä','–ü—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å','–ë–∏–∑–Ω–µ—Å–º–µ–Ω','–°—Ç—Ä–∞—Ç–µ–≥','–ú–∞–≥–Ω–∞—Ç','–¢–∏—Ç–∞–Ω','–õ–µ–≥–µ–Ω–¥–∞'];

// === NAV ===
document.querySelectorAll('.nbtn').forEach(b=>{
    b.onclick=()=>{
        document.querySelectorAll('.nbtn').forEach(x=>x.classList.remove('on'));
        b.classList.add('on');
        document.querySelectorAll('.vw').forEach(v=>v.classList.remove('on'));
        document.getElementById('v-'+b.dataset.v).classList.add('on');
    };
});

// === FILTERS ===
document.querySelectorAll('.fb').forEach(b=>{
    b.onclick=()=>{b.parentElement.querySelectorAll('.fb').forEach(x=>x.classList.remove('on'));b.classList.add('on')};
});

// === CHAT ===
async function send(){
    const inp=document.getElementById('chatInp');
    const msg=inp.value.trim();
    if(!msg)return;
    document.getElementById('sendBtn').disabled=true;
    inp.value='';inp.style.height='auto';
    addMsg('user',msg);
    S.hist.push({role:'user',content:msg});
    document.getElementById('typing').classList.add('on');
    try{
        const r=await fetch('/api/chat',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({message:msg,context:S.hist.slice(-20)})});
        const d=await r.json();
        if(d.error){addMsg('jarvis','‚ùå '+d.error)}
        else{addMsg('jarvis',d.reply,d.tokens);S.hist.push({role:'assistant',content:d.reply});addXP(25,'–ß–∞—Ç')}
    }catch(e){addMsg('jarvis','‚ùå –°–µ—Ä–≤–µ—Ä –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç. –ó–∞–ø—É—Å—Ç–∏: python server.py\n\n'+e.message)}
    document.getElementById('typing').classList.remove('on');
    document.getElementById('sendBtn').disabled=false;
}

function addMsg(role,text,tok){
    const c=document.getElementById('chatMsgs');
    const t=new Date().toLocaleTimeString('ru',{hour:'2-digit',minute:'2-digit'});
    const u=role==='user';
    let tokH='';
    if(tok)tokH=`<div class="m-tok">üìä ${tok.input}‚Üí${tok.output} —Ç–æ–∫–µ–Ω–æ–≤</div>`;
    c.insertAdjacentHTML('beforeend',`<div class="msg ${u?'usr':''}"><div class="m-av ${u?'u':'j'}">${u?'üë§':'J'}</div><div class="m-body"><div class="m-name ${u?'un':'jn'}">${u?'–¢—ã':'JARVIS 2.0'}</div><div class="m-text">${esc(text)}</div><div class="m-time">${t}</div>${tokH}</div></div>`);
    c.scrollTop=c.scrollHeight;
}

function chatKey(e){if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();send()}e.target.style.height='auto';e.target.style.height=Math.min(e.target.scrollHeight,100)+'px'}
function esc(t){const d=document.createElement('div');d.textContent=t;return d.innerHTML}

// === NICHE ANALYSIS ===
async function analyzeNiche(name){
    S.niche=name;
    const m=document.getElementById('mNiche');
    const res=document.getElementById('nicheRes');
    m.classList.add('on');
    res.textContent='‚è≥ JARVIS –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç ¬´'+name+'¬ª...\n\n–ó–∞–ø—Ä–æ—Å –≤ Claude...';
    try{
        const r=await fetch('/api/analyze-niche',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({niche:name})});
        const d=await r.json();
        res.textContent=d.error?'‚ùå '+d.error:d.analysis;
        if(!d.error)addXP(50,'–ê–Ω–∞–ª–∏–∑ –Ω–∏—à–∏');
    }catch(e){res.textContent='‚ùå –°–µ—Ä–≤–µ—Ä –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç.\n\n–ó–∞–ø—É—Å—Ç–∏: python server.py\n\n'+e.message}
}

function nicheToProj(){
    document.getElementById('mNiche').classList.remove('on');
    document.getElementById('nName').value=S.niche;
    openModal();
}

// === PROJECTS ===
function openModal(){document.getElementById('mNew').classList.add('on')}
function closeModal(){document.getElementById('mNew').classList.remove('on')}

async function createProj(){
    const name=document.getElementById('nName').value.trim();
    const desc=document.getElementById('nDesc').value.trim();
    const mon=document.getElementById('nMon').value.trim();
    if(!name)return alert('–í–≤–µ–¥–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ');
    closeModal();
    try{
        const r=await fetch('/api/projects',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({name,description:desc,monetization:mon})});
        const p=await r.json();
        addProjToSidebar(p);
    }catch(e){addProjToSidebar({name,id:Date.now(),status:'active',sprint:1})}
    addXP(100,'–ü—Ä–æ–µ–∫—Ç: '+name);
    addTL('–°–æ–∑–¥–∞–Ω: '+name);
    // Go to chat and generate sprints
    document.querySelector('[data-v="chat"]').click();
    document.getElementById('chatInp').value=`–†–∞–∑–±–µ–π –Ω–∞ 4 —Å–ø—Ä–∏–Ω—Ç–∞: "${name}". ${desc} ${mon?'–ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è: '+mon:''}`;
    send();
    document.getElementById('nName').value='';
    document.getElementById('nDesc').value='';
    document.getElementById('nMon').value='';
}

function addProjToSidebar(p){
    const list=document.getElementById('projList');
    const icons=['üèóÔ∏è','üìö','ü§ñ','üé®','üíä','üéÆ','üõí','üì±'];
    const colors=['var(--cyan-d)','var(--violet-d)','var(--green-d)','var(--yellow-d)'];
    const ic=icons[Math.floor(Math.random()*icons.length)];
    const co=colors[Math.floor(Math.random()*colors.length)];
    list.insertAdjacentHTML('beforeend',`<div class="pi" onclick="this.classList.toggle('on')"><div class="pi-ic" style="background:${co}">${ic}</div><div class="pi-info"><div class="pi-name">${esc(p.name)}</div><div class="pi-meta"><span class="dot dot-g"></span>–°–ø—Ä–∏–Ω—Ç ${p.sprint||1}</div></div><div class="pi-rev">‚Äî</div></div>`);
    const cnt=list.querySelectorAll('.pi').length;
    document.getElementById('pCnt').textContent=cnt;
    document.getElementById('dProj').textContent=cnt;
    document.getElementById('sProj').textContent=cnt;
}

// === QUESTS ===
function togQ(item){
    item.classList.toggle('dn');
    const ch=item.querySelector('.qch');
    ch.textContent=item.classList.contains('dn')?'‚úì':'';
    const card=item.closest('.qc');
    const all=card.querySelectorAll('.qi');
    const done=card.querySelectorAll('.qi.dn');
    const pct=Math.round(done.length/all.length*100);
    card.querySelector('.qpf').style.width=pct+'%';
    card.querySelector('.qpt').textContent=done.length+'/'+all.length;
    if(item.classList.contains('dn')){addXP(25,'–ó–∞–¥–∞—á–∞');showXP(item,'+25 XP')}
    if(done.length===all.length){addXP(200,'–ö–≤–µ—Å—Ç –≥–æ—Ç–æ–≤!');addTL('‚úÖ –ö–≤–µ—Å—Ç: '+card.querySelector('.qn').textContent)}
}

// === XP ===
function addXP(amt,reason=''){
    S.xp+=amt;
    while(S.xp>=S.xpN){S.xp-=S.xpN;S.lvl++;S.xpN=Math.floor(S.xpN*1.3);const ri=Math.min(Math.floor(S.lvl/5),RANKS.length-1);S.rank=RANKS[ri];addTL('üéâ LEVEL UP! '+S.lvl+' ‚Äî '+S.rank)}
    updPlayer();
    fetch('/api/player/add-xp',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({amount:amt,reason})}).catch(()=>{});
}

function updPlayer(){
    document.getElementById('pRank').textContent=`‚ö° –£—Ä.${S.lvl} ‚Äî ${S.rank}`;
    document.getElementById('pXpT').textContent=`${S.xp}/${S.xpN} XP`;
    document.getElementById('xFill').style.width=(S.xp/S.xpN*100)+'%';
    document.getElementById('dXP').textContent=S.xp;
}

function showXP(el,txt){
    const p=document.createElement('div');p.className='xpp';p.textContent=txt;
    const r=el.getBoundingClientRect();
    p.style.left=(r.right+6)+'px';p.style.top=r.top+'px';
    document.body.appendChild(p);setTimeout(()=>p.remove(),1000);
}

// === TIMELINE ===
function addTL(text){
    const tl=document.getElementById('timeline');
    const t=new Date().toLocaleTimeString('ru',{hour:'2-digit',minute:'2-digit'});
    tl.insertAdjacentHTML('afterbegin',`<div class="tli dn"><div class="tl-tm">${t}</div><div class="tl-tx">${esc(text)}</div></div>`);
}

// === CHART ===
function renderChart(){
    const data=[{d:'–ü–Ω',v:520},{d:'–í—Ç',v:680},{d:'–°—Ä',v:450},{d:'–ß—Ç',v:790},{d:'–ü—Ç',v:620},{d:'–°–±',v:340},{d:'–í—Å',v:880}];
    const mx=Math.max(...data.map(x=>x.v));
    const bars=document.getElementById('cBars');
    const labels=document.getElementById('cLabels');
    data.forEach(x=>{
        const b=document.createElement('div');b.className='cb';
        const h=x.v/mx*100;b.style.height=h+'%';
        b.style.background=`linear-gradient(180deg,${h>70?'var(--violet)':'var(--cyan)'},rgba(0,0,0,0.3))`;
        bars.appendChild(b);
        const l=document.createElement('div');l.className='cl';l.textContent=x.d;labels.appendChild(l);
    });
}

// === WEEKLY TIMER ===
function updTimer(){
    const now=new Date();const end=new Date(now);
    end.setDate(now.getDate()+(7-now.getDay()));end.setHours(23,59,59);
    const diff=end-now;const d=Math.floor(diff/864e5);const h=Math.floor(diff%864e5/36e5);const m=Math.floor(diff%36e5/6e4);
    document.getElementById('wmTimer').textContent=`${d}–¥ ${h}—á ${m}–º`;
}

// === LOAD DATA ===
async function loadData(){
    try{
        const pr=await fetch('/api/player');const pl=await pr.json();
        S.lvl=pl.level||1;S.xp=pl.xp||0;S.xpN=pl.xp_to_next||1000;S.rank=pl.rank||'–ù–æ–≤–∏—á–æ–∫';
        updPlayer();
        const projR=await fetch('/api/projects');const projD=await projR.json();
        if(projD.projects)projD.projects.forEach(p=>addProjToSidebar(p));
        addTL('–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
    }catch(e){console.log('–û—Ñ—Ñ–ª–∞–π–Ω');addTL('–û—Ñ—Ñ–ª–∞–π–Ω (–∑–∞–ø—É—Å—Ç–∏ server.py)')}
}

// === INIT ===
renderChart();updPlayer();loadData();updTimer();setInterval(updTimer,60000);
</script>
</body>
</html>
